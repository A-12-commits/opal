# Opal

**Opal is a ruby to javascript compiler.** Opal aims to take ruby files
and generate efficient javascript that maintains rubys features. Opal
will, by default, generate fast and efficient code in preference to
keeping all ruby features.

Opal comes with an implementation of the ruby corelib, written in ruby,
that uses a bundled runtime (written in javascript) that tie all the
features together. Whenever possible Opal bridges to native javascript
features under the hood. The Opal gem includes the compiler used to
convert ruby sources into javascript.

Opal is [hosted on github](http://github.com/adambeynon/opal), and there
is a Freenode IRC channel at `#opal`.

## Downloads

The Opal runtime and corelib are distributed here, and are required to
run any code generated by opal.

[Opal version 0.3.16](http://opalrb.org/opal.js) _(120kb
Uncompressed, 13.7kb Minified And Gzipped)_

## Installation

Opal comes distributed as a gem, so either install with:

```
gem install opal
```

Or add to your Gemfile:

``` ruby
gem "opal"
```

## Usage

To quickly compile ruby code into javascript, use the `Opal.parse()`
method which returns a string of javascript code:

```ruby
require 'opal'

Opal.parse("[1, 2, 3, 4].each { |a| puts a }")
```

This will return a string of javascript similar to the following:

```javascript
(function() {
  // compiled ruby
}).call(Opal.top);
```

This can then be written to a file and run in any browser.

### Creating a rake task

Using a Rakefile makes it simple to build your application code.
Assuming your code is in a file `app.rb`, add a rake task:

```ruby
# Rakefile

require 'opal'

desc "Build opal application"
task :build do
  src = File.read 'app.rb'
  js  = Opal.parse src

  File.open('app.js', 'w+') do |out|
    out.write js
  end
end
```

Running `rake build` will then read your app code, compile it and then
write it out to a file ready to load in a web browser.

### Setting up html file

The generated `app.js` file can just be added into any HTML page. The
opal runtime needs to be loaded first (you can download that above).

```html
<!doctype html>
<html>
<head>
  <title>Test Opal App</title>
</head>
<body>
  <script src="opal.js"></script>
  <script src="app.js"></script>
</body>
</html>
```

When using `Opal.parse()` as above, the generated code will be run
as soon as the page loads. Open the browsers console and you should
see the 4 numbers printed to the console.

## Change Log

### Edge

* Added HEREDOCS support in parser
* Parser now handles masgn (mass/multi assignments)
* More useful DependencyBuilder class to build gems dependencies
* Blocks no longer passed as an argument in method calls

### 0.3.15

Initial Release.